CREATE TABLE storage_result (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    storage_revision_id BIGINT NOT NULL,
    task_result_id BIGINT NOT NULL,
    CONSTRAINT pk_storage_result PRIMARY KEY (id)
);
ALTER TABLE storage_result ADD CONSTRAINT FK_STORAGE_RESULT_ON_STORAGE_REVISION FOREIGN KEY (storage_revision_id) REFERENCES storage_revision (id);
ALTER TABLE storage_result ADD CONSTRAINT FK_STORAGE_RESULT_ON_TASK_RESULT FOREIGN KEY (task_result_id) REFERENCES task_result (id);
CREATE INDEX idx_storage_result_task_result_id ON storage_result(task_result_id);

CREATE TABLE storage_result_value (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    storage_result_id BIGINT,
    date_time_start TIMESTAMP WITHOUT TIME ZONE NOT NULL,
    date_time_end TIMESTAMP WITHOUT TIME ZONE NOT NULL,
    charge DOUBLE PRECISION NOT NULL,
    discharge DOUBLE PRECISION NOT NULL,
    energy DOUBLE PRECISION NOT NULL,
    storage_mode INTEGER NOT NULL,
    CONSTRAINT pk_storage_result_value PRIMARY KEY (id)
);
ALTER TABLE storage_result_value ADD CONSTRAINT FK_STORAGE_RESULT_VALUE_ON_STORAGE_RESULT FOREIGN KEY (storage_result_id) REFERENCES storage_result (id);
CREATE INDEX idx_storage_result_value_storage_result_id ON storage_result_value(storage_result_id);